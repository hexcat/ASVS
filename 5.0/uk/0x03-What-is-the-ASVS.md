# Що таке ASVS?

Стандарт верифікації вимог до безпеки застосунків (ASVS) визначає вимоги до безпеки веб-застосунків і сервісів та є цінним ресурсом для всіх, хто прагне проєктувати, розробляти, підтримувати безпечні застосунки або оцінювати їхню безпеку.

Цей розділ описує основні аспекти використання ASVS, зокрема його сферу застосування, структуру рівнів пріоритетності та основні сценарії використання стандарту.

## Сфера застосування ASVS

Сфера застосування ASVS визначається його назвою: Застосунок, Безпека, Верифікація та Стандарт. Вона встановлює, які вимоги включено або виключено, із всеохопною метою визначення принципів безпеки, яких необхідно досягти. Сфера також охоплює вимоги до документації, які є основою для впровадження заходів безпеки.

Для зловмисників не існує жодних меж. Тому вимоги ASVS слід оцінювати разом із рекомендаціями щодо інших аспектів життєвого циклу застосунку, включно з CI/CD-процесами, хостингом та операційною діяльностю.

### Застосунок

ASVS визначає "застосунок" як програмний продукт, що розробляється, у який мають бути інтегровані контрольні заходи безпеки. ASVS не встановлює вимог щодо процесів життєвого циклу розробки і не регламентує, як саме слід будувати застосунок за допомогою CI/CD-пайплайну; натомість він визначає результати безпеки, яких необхідно досягти безпосередньо в самому продукті.

Компоненти, що обслуговують, модифікують або перевіряють HTTP-трафік, такі як Веб-застосункові брандмауери (WAFs), балансувальники навантаження або проксі-сервери, можуть вважатися частиною застосунку для відповідних цілей, оскільки деякі контрольні заходи безпеки безпосередньо залежать від них або можуть реалізовуватися за їх допомогою. Ці компоненти слід враховувати під час виконання вимог, пов’язаних із кешованими відповідями, обмеженням кількості запитів або обмеження вхідних і вихідних з’єднань залежно від джерела та призначення.

Натомість, ASVS зазвичай не охоплює вимоги, що не стосуються безпосередньо самого застосунку або належать до конфігурації, яка виходить за межі його відповідальності. Наприклад, аспекти, пов’язані з DNS, зазвичай належать до відповідальності іншої команди чи функції.

Як і в попередньому випадку, хоча застосунок відповідає за обробку вхідних даних і формування вихідних, взаємодія зовнішніх процесів із самим застосунком або його даними вважається поза межами сфери дії ASVS. Наприклад, резервне копіювання застосунку або його даних зазвичай виконується зовнішнім процесом і не контролюється самим застосунком або його розробниками.

### Безпека

Кожна вимога має мати доказовий вплив на безпеку. Відсутність такої вимоги має призводити до зниження рівня безпеки застосунку, а впровадження такої вимоги має зменшувати ймовірність або ступінь впливу ризику безпеки.

Усі інші фактори, такі як функціональні аспекти, стиль коду чи вимоги політики, не розглядаються у межах цього стандарту.

### Верифікація

Вимога має бути перевірною, а результат перевірки повинен має бути "пройшов" або "не пройшов".

### Стандарт

ASVS розроблено як збірку вимог безпеки, які необхідно реалізувати для відповідності стандарту. Це означає, що вимоги обмежуються визначенням цілі безпеки, яку потрібно досягти. Іншу пов’язану інформацію можна створювати на основі ASVS або пов’язувати через відповідності (mapping).

Конкретно, OWASP має багато проєктів, і ASVS свідомо уникає дублювання з матеріалами інших проєктів. Наприклад, розробники можуть запитувати: "Як реалізувати певну вимогу у моїй конкретній технології чи середовищі?" — на це питання має відповідати проєкт Cheat Sheet Series. Перевіряльники можуть запитати: "Як протестувати цю вимогу в цьому середовищі?" — відповідь на це має міститися в проєкті Web Security Testing Guide.

Хоча ASVS призначений не лише для експертів із безпеки, він передбачає, що читач має технічні знання для розуміння змісту або здатність досліджувати окремі поняття.

### Вимога

Слово вимога в ASVS вживається у вузькому значенні, оскільки воно описує те, чого необхідно досягти, щоб її виконати. ASVS містить лише вимоги (must) і не містить рекомендацій (should) як основної умови.

Іншими словами, рекомендації, незалежно від того чи є вони лише одним із багатьох можливих варіантів розв’язання проблеми або стосуються стилю коду, не відповідають визначенню вимоги.

Вимоги ASVS спрямовані на відображення конкретних принципів безпеки без надмірної прив’язки до реалізації чи технологій, водночас залишаючись самодостатніми й зрозумілими щодо своєї мети. Це також означає, що вимоги не орієнтовані на певний метод перевірки чи спосіб реалізації.

### Задокументовані рішення щодо реалізації безпеки

У сфері безпеки програмного забезпечення, завчасне планування архітектури безпеки та механізмів, які будуть використовуватись, забезпечує більш послідовну й надійну реалізацію у кінцевому продукті або функціоналі.

Крім того, для деяких вимог реалізація може бути складною та дуже специфічною для потреб конкретного застосунку. Типовими прикладами є дозволи, перевірка вхідних даних та захисні механізми навколо різних рівнів чутливих даних.

Щоб врахувати це, замість загальних заяв на кшталт "всі дані мають бути зашифровані" або спроб охопити кожен можливий випадок використання у вимозі, було включено вимоги до документації, які зобов’язують розробника застосунку документувати свій підхід та налаштування відповідних контролів. Це потім може бути перевірено на відповідність, а фактичну реалізацію порівняно з документацією, щоб оцінити, чи відповідає реалізація очікуванням.

Ці вимоги призначені для документування рішень, які організація, що розробляє застосунок, прийняла щодо способів впровадження певних вимог безпеки.

Вимоги до документації завжди розміщуються на початку розділу (однак не всі розділи їх містять) і завжди мають відповідну вимогу до впровадження, згідно з якою задокументовані рішення мають бути реально втілені. Сутність полягає в тому, що перевірка наявності документації та перевірка фактичного впровадження це дві окремі дії.

Існує два основні чинники, що зумовлюють включення цих вимог. Перший чинник полягає в тому, що вимога безпеки часто передбачає застосування певних правил, наприклад, які типи файлів дозволено завантажувати, які бізнес-контролі слід забезпечити, які символи дозволені у певному полі. Ці правила відрізняються для кожного застосунку, тому ASVS не може однозначно визначати, якими вони мають бути, і навіть чек-лист або детальніші рекомендації не допоможуть у цьому випадку. Аналогічно, без документування таких рішень неможливо буде провести перевірку вимог, що реалізують ці рішення.

Другий чинник полягає в тому, що для певних вимог важливо надати розробникам застосунків гнучкість у виборі способів вирішення конкретних питань безпеки. Наприклад, у попередніх версіях ASVS правила тайм-ауту сесій були дуже жорсткими. Практично ж, багато застосунків, особливо ті, які орієнтовані на кінцевого користувача, мають значно м’якші правила і надають перевагу впровадженню інших заходів пом’якшення ризиків. Вимоги до документації, відповідно, чітко передбачають гнучкість у цьому питанні.

Очевидно, що прийняття та документування таких рішень не очікується від окремих розробників, а здійснюється організацією в цілому, яка відповідально приймає ці рішення та забезпечує їх донесення до розробників, які, у свою чергу, мають дотримуватися встановлених вимог.

Надання розробникам специфікацій та дизайнів для нових функцій та можливостей є стандартною частиною розробки програмного забезпечення. Аналогічно, від розробників очікується використання загальних компонентів і механізмів користувацького інтерфейсу, а не щоращу прийняття власних рішень. Таким чином, поширення цього підходу на сферу безпеки не має викликати здивування чи суперечностей.

Існує також гнучкість у способах досягнення цього. Рішення з безпеки можуть бути задокументовані у вигляді письмового документа, на який розробники повинні посилатися. Альтернативою є те, що рішення з безпеки можуть бути задокументовані та реалізовані у спільній бібліотеці коду, яку всі розробники зобов’язані використовувати. В обох випадках досягається бажаний результат.

## Рівні верифікації вимог до безпеки застосунків

ASVS визначає три рівні верифікації безпеки, кожен з яких відрізняється глибиною та складністю. Загальна мета полягає в тому, щоб організації починали з першого рівня для усунення найбільш критичних питань безпеки, а згодом переходили до вищих рівнів відповідно до потреб організації та застосунку. У документі та текстах вимог рівні можуть позначатися як L1, L2 та L3.

Кожен рівень ASVS визначає вимоги до безпеки, які необхідно досягнути на цьому рівні, при цьому вимоги вищих рівнів вважаються рекомендаціями.

Щоб уникнути дублювання вимог або вимог, які вже є не релевантними на вищих рівнях, деякі вимоги застосовуються до конкретного рівня, але на вищих рівнях мають більш жорсткі умови.

### Оцінка рівнів

Рівні визначаються шляхом пріоритетної оцінки кожної вимоги на основі досвіду впровадження та тестування вимог безпеки. Основний акцент робиться на порівнянні зниження ризику із зусиллями на впровадження вимоги. Ще одним ключовим фактором є підтримання низького порогу для початку використання стандарту.

Зниження ризику враховує ступінь, у якій вимога зменшує рівень ризику безпеки в застосунку, враховуючи класичні фактори впливу — Конфіденційність, Цілісність і Доступність, а також чи є це первинним рівнем захисту або ж багаторівневим захистом.

Серйозні обговорення щодо критеріїв і рішень по рівнях призвели до розподілу, що має бути правильним для більшості випадків, водночас визнаючи, що він може не підходити на всі 100% для кожної ситуації. Це означає, що в деяких випадках організації можуть за бажанням пріоритетизувати вимоги з вищих рівнів на ранніх етапах, враховуючи свої конкретні ризики.

Типи вимог для кожного рівня можна охарактеризувати таким чином.

### Рівень 1

Цей рівень містить мінімальні вимоги, які слід враховувати при захисті застосунку, і являє собою критичну відправну точку. Він охоплює близько 20% вимог ASVS. Мета цього рівня це максимально зменшити кількість вимог, щоб знизити поріг входу.

Вимоги цього рівня, як правило, є критичними або базовими, становлять перший рівень захисту для запобігання поширеним атакам, які не потребують наявності інших вразливостей чи передумов для експлуатації.

Окрім вимог першого рівня захисту, деякі вимоги мають менший вплив на вищих рівнях, наприклад, ті, що стосуються паролів. Вони більш важливі для Рівня 1, адже на вищих рівнях актуальними стають вимоги багатофакторної автентифікації.

Рівень 1 не завжди можна перевірити шляхом зовнішнього пентесту без внутрішнього доступу до документації чи коду (наприклад, при "black box" тестуванні), проте менша кількість вимог має полегшувати їх верифікацію.

### Рівень 2

Більшість застосунків повинні прагнути досягти цього рівня безпеки. Приблизно 50% вимог ASVS належать до Рівня 2, що означає, що для відповідності цьому рівню застосунок має реалізувати близько 70% вимог ASVS (всі вимоги Рівнів 1 і 2).

Ці вимоги, як правило, стосуються менш поширених атак або складніших засобів захисту від поширених атак. Вони все ще можуть слугувати першим рівнем захисту або ж вимагати виконання певних передумов для успішної атаки.

### Рівень 3

Цей рівень має бути метою для застосунків, які прагнуть продемонструвати найвищі рівні безпеки, і містить останні приблизно 30% вимог для відповідності.

Вимоги цього розділу зазвичай стосуються механізмів глибинного захисту або інших корисних, але складних для впровадження заходів контролю.

### Який рівень досягати

Рівні, засновані на пріоритетах, спрямовані на відображення зрілості організації та застосунку у сфері безпеки застосунків. Замість того, щоб ASVS диктував, на якому рівні має бути застосунок, організація повинна проаналізувати свої ризики та самостійно визначити, якого рівня вона прагне досягти, залежно від чутливості застосунку та, звісно, очікувань його користувачів.

Наприклад, стартап на ранній стадії, який збирає обмежену кількість чутливих даних, може вирішити зосередитися на Рівні 1 як початковій цілі безпеки, тоді як банк навряд чи зможе виправдати перед своїми клієнтами будь-який рівень нижчий за Рівень 3 для свого застосунку для онлайн-банкінгу.

## Як користуватися ASVS

### Структура ASVS

ASVS складається приблизно з 350 вимог, які розподілені по 17 розділах, кожен із яких поділяється на секції.

Метою поділу на розділи та секції є спрощення вибору або відфільтрування розділів та секцій залежно від того, що актуально для застосунку. Наприклад, для машинного API (machine-to-machine), вимоги розділу V3, які стосуються веб-фронтендів, будуть неактуальними. Якщо ж OAuth чи WebRTC не використовуються, відповідні розділи також можна пропустити.

### Стратегія релізу

ASVS релізи здійснюються за схемою "Major.Minor.Patch", де кожне число інформує про характер змін у релізі. У мажорному релізі змінюється перше число, у мінорному - друге, а в патч-релізі - третє.

* Мажорний реліз - повна реорганізація, майже все може змінитися, включно з номерами вимог. Необхідна повторна оцінка відповідності (наприклад, 4.0.3 -> 5.0.0).
* Мінорний реліз - можуть додаватися або видалятися вимоги, але загальна нумерація залишається незмінною. Повторна оцінка відповідності потрібна, але вона має бути простішою (наприклад, 5.0.0 -> 5.1.0).
* Патч-реліз - вимоги можуть бути видалені (наприклад, якщо вони дублюються або застаріли) або пом’якшені, при цьому застосунок, який відповідав попередньому релізу, також відповідатиме цьому патчу (наприклад, 5.0.0 -> 5.0.1).

Вищезазначене стосується виключно вимог у ASVS. Зміни у супровідному тексті та іншому вмісті, наприклад у додатках, не будуть вважаються зламною зміною (breaking change).

### Гнучкість застосування ASVS

Декілька наведених вище пунктів, таких як вимоги до документації та механізм рівнів, забезпечують можливість гнучкого використання ASVS з урахуванням специфіки конкретної організації.

Крім того, організаціям настійно рекомендується створювати власну версію (форк), специфічну для організації або домену, яка коригує вимоги залежно від особливостей і рівня ризиків їхніх застосунків. Водночас важливо зберігати простежуваність, щоб проходження вимоги 4.1.1 означало одне й те саме в усіх версіях.

Ідеальним є створення кожною організацією власної версії ASVS, вилучаючи нерелевантні розділи (наприклад, GraphQL, WebSockets, SOAP, якщо вони не використовуються). Організаційна версія ASVS або додаток до неї також є гарним місцем для надання специфічних рекомендацій щодо впровадження, зокрема опису бібліотек чи ресурсів, які слід використовувати для виконання вимог.

### Як посилатися на вимоги ASVS

Кожна вимога має ідентифікатор у форматі `<розділ>.<підрозділ>.<вимога>`, де кожен елемент це число. Наприклад, `1.11.3`.

* Значення `<розділ>` відповідає розділу, з якого походить вимога; наприклад, всі вимоги формату `1.#.#` належать до розділу 'Кодування та санітизація'.
* Значення `<підрозділ>` відповідає підрозділу всередині цього розділу, де розміщена вимога; наприклад, всі вимоги формату `1.2.#` належать до підрозділу 'Запобігання ін’єкціям' розділу 'Кодування та санітизація'.
* Значення `<вимога>` ідентифікує конкретну вимогу в межах розділу та підрозділу; наприклад, `1.2.5`, яка станом на версію 5.0.0 цього стандарту має такий зміст:

> Переконайтесь, що застосунок захищений від OS command injection і також, що виклики операційної системи використовують параметризовані запити або контекстне кодування для виводу командного рядка.

Оскільки ідентифікатори можуть змінюватися між версіями стандарту, бажано, щоб інші документи, звіти або інструменти використовували наступний формат: `v<версія>-<розділ>.<секція>.<вимога>`, де: 'версія' це тег версії ASVS. Наприклад: `v5.0.0-1.2.5` слід розуміти як 5-ту вимогу з секції 'Запобігання ін’єкціям' розділу 'Кодування та санітизація' у версії 5.0.0. (Це можна коротко представити як `v<версія>-<ідентифікатор_вимоги>`.)

Примітка: літера `v`, що передує номеру версії у форматі, завжди має бути написана з малої літери.

Якщо ідентифікатори використовуються без включення елемента `v<версія>`, слід вважати, що вони посилаються на найновіший вміст Стандарту верифікації вимог до безпеки застосунків. Оскільки стандарт постійно розширюється та змінюється, це може створити труднощі, тому авторам документів або розробникам рекомендується завжди вказувати версію.

Списки вимог ASVS доступні у форматах CSV, JSON та інших, що може бути зручно для посилань або програмного використання.

### Форкування ASVS

Організації можуть отримати користь від впровадження ASVS, обравши один із трьох рівнів або створивши специфічний форк для конкретного домену, який адаптує вимоги відповідно до рівня ризику для застосунку. Такий підхід заохочується, за умови збереження простежуваності, щоб проходження вимоги 4.1.1 означало одне й те саме в усіх версіях.

Ідеально, якщо кожна організація створить власну адаптовану версію ASVS, вилучивши нерелевантні розділи (наприклад, GraphQL, WebSockets, SOAP, якщо вони не використовуються). Форкування слід починати з Рівня 1 ASVS як базового, поступово переходячи до Рівнів 2 або 3 залежно від рівня ризику застосунку.

## Варіанти використання ASVS

ASVS можна використовувати для оцінки безпеки застосунку і ця тема докладніше розглядається в наступному розділі. Водночас існує й кілька інших можливих сценаріїв використання ASVS (або форкованої версії), які також були визначені.

### Як детальний посібник з безпечної архітектури

Одним із найпоширеніших способів використання Стандарту верифікації вимог до безпеки застосунків є його застосування як ресурсу для архітекторів з безпеки. Наразі існує обмежена кількість матеріалів щодо побудови безпечної архітектури застосунків, особливо сучасних. ASVS може заповнити ці прогалини, дозволяючи архітекторам з безпеки обирати кращі механізми контролю для типових проблем, таких як шаблони захисту даних і стратегії валідації вхідних даних. Особливо корисними для цього будуть вимоги до архітектури та документації.

### Як спеціалізоване посилання для безпечного кодування

ASVS може бути використаний як основа для створення довідника з безпечного кодування під час розробки застосунків, допомагаючи розробникам враховувати аспекти безпеки при створенні програмного забезпечення. Хоча ASVS може слугувати базою, організаціям варто підготувати власні конкретні інструкції, які будуть чіткими, узгодженими та, за можливості, створеними на основі рекомендацій інженерів або архітекторів з безпеки. Крім того, організаціям рекомендується за можливості розробити затверджені механізми безпеки та бібліотеки, які можна включити в ці інструкції і використовувати під час розробки.

### Як настанову для автоматизованих юніт- та інтеграційних тестів

ASVS розроблений таким чином, щоб бути легко перевірюваним. Деякі вимоги перевіряються технічними засобами, тоді як інші (наприклад, вимоги до архітектури та документації) можуть потребувати перегляду документації або архітектури. Створюючи юніт- та інтеграційні тести, які перевіряють та проводять фаззинг на конкретні й релевантні зловмисні сценарії відповідно до технічно перевірюваних вимог, можна значно спростити перевірку того, що захисні механізми працюють належним чином у кожній збірці. Наприклад, до тестового набору для контролера входу можна додати перевірки параметра імені користувача на наявність типових імен за замовчуванням, можливість визначення існування облікових записів, брутфорсинг, ін’єкцію LDAP та SQL, XSS тощо. Аналогічно, перевірка параметра пароля повинна охоплювати поширені паролі, довжину пароля, ін’єкцію нульового байта, видалення параметра, XSS та інші атаки.

### Для навчаннь з безпечної розробки

ASVS також може використовуватись для визначення характеристик безпечного програмного забезпечення. Багато курсів з "безпечного написання коду" насправді є курсами етичного хакінгу з невеликою кількістю порад щодо написання коду. Це не завжди допомагає розробникам писати більш безпечний код. Натомість, курси з безпечної розробки можуть використовувати ASVS, зосереджуючись на позитивних практиках і механізмах, описаних у ASVS стандарті, а не лише на "Топ-10" негативних практиках, яких слід уникати. Структура ASVS також логічно впорядкована і добре підходить для покрокового вивчення різних аспектів забезпечення безпеки застосунків.

### Як основа для закупівлі безпечного програмного забезпечення

ASVS є чудовим фреймворком для організації процесу закупівлі безпечного програмного забезпечення або замовлення індивідуальних послуг з розробки. Замовник може просто встановити вимогу, що програмне забезпечення, яке він планує придбати, повинно бути розроблене відповідно до ASVS рівня X, і вимагати від постачальника підтвердження, що це програмне забезпечення відповідає ASVS рівню X.

## Застосування ASVS на практиці

Різні загрози мають різні мотивації. Деякі галузі мають унікальні інформаційні та технологічні активи та регуляторні вимоги у конкретному домені.

Організаціям настійливо рекомендується ретельно проаналізувати свої унікальні характеристики ризиків, виходячи з характеру бізнесу, і на основі цього обрати відповідний рівень ASVS, що відповідатиме як рівню ризику, так і бізнес-вимогам.
